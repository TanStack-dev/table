---
source-updated-at: '2024-03-28T21:06:30.000Z'
translation-updated-at: '2025-05-08T23:40:08.738Z'
title: å¸¸è¦‹å•é¡Œ
---
## å¦‚ä½•é¿å…ç„¡é™æ¸²æŸ“è¿´åœˆï¼Ÿ

å¦‚æœä½ ä½¿ç”¨ Reactï¼Œæœ‰ä¸€å€‹å¸¸è¦‹çš„é™·é˜±å¯èƒ½å°è‡´ç„¡é™æ¸²æŸ“ã€‚å¦‚æœä½ æ²’æœ‰ç‚º `columns`ã€`data` æˆ– `state` æä¾›ç©©å®šçš„åƒè€ƒ (stable reference)ï¼ŒReact æœƒåœ¨è¡¨æ ¼ç‹€æ…‹ç™¼ç”Ÿä»»ä½•è®ŠåŒ–æ™‚é€²å…¥ç„¡é™é‡æ–°æ¸²æŸ“çš„è¿´åœˆã€‚

ç‚ºä»€éº¼æœƒé€™æ¨£ï¼Ÿé€™æ˜¯ TanStack Table çš„éŒ¯èª¤å—ï¼Ÿ**ä¸æ˜¯**ï¼Œé€™ä¸æ˜¯éŒ¯èª¤ã€‚*é€™åŸºæœ¬ä¸Šæ˜¯ React çš„é‹ä½œæ–¹å¼*ï¼Œå¦¥å–„ç®¡ç†ä½ çš„ columnsã€data å’Œ state å°±èƒ½é¿å…é€™å€‹å•é¡Œã€‚

TanStack Table çš„è¨­è¨ˆæ˜¯ç•¶å‚³å…¥è¡¨æ ¼çš„ `data` æˆ– `columns` ç™¼ç”Ÿè®ŠåŒ–ï¼Œæˆ–è¡¨æ ¼çš„ä»»ä½•ç‹€æ…‹ç™¼ç”Ÿè®ŠåŒ–æ™‚ï¼Œå°±æœƒè§¸ç™¼é‡æ–°æ¸²æŸ“ã€‚

> æœªèƒ½ç‚º `columns` æˆ– `data` æä¾›ç©©å®šçš„åƒè€ƒå¯èƒ½å°è‡´ç„¡é™é‡æ–°æ¸²æŸ“è¿´åœˆã€‚

### é™·é˜± 1ï¼šåœ¨æ¯æ¬¡æ¸²æŸ“æ™‚å‰µå»ºæ–°çš„ columns æˆ– data

```js
export default function MyComponent() {
  //ğŸ˜µ éŒ¯èª¤ï¼šé€™æœƒå°è‡´ç„¡é™é‡æ–°æ¸²æŸ“è¿´åœˆï¼Œå› ç‚º `columns` åœ¨æ¯æ¬¡æ¸²æŸ“æ™‚éƒ½è¢«é‡æ–°å®šç¾©ç‚ºä¸€å€‹æ–°é™£åˆ—ï¼
  const columns = [
    // ...
  ];

  //ğŸ˜µ éŒ¯èª¤ï¼šé€™æœƒå°è‡´ç„¡é™é‡æ–°æ¸²æŸ“è¿´åœˆï¼Œå› ç‚º `data` åœ¨æ¯æ¬¡æ¸²æŸ“æ™‚éƒ½è¢«é‡æ–°å®šç¾©ç‚ºä¸€å€‹æ–°é™£åˆ—ï¼
  const data = [
    // ...
  ];

  //âŒ Columns å’Œ data åœ¨èˆ‡ `useReactTable` ç›¸åŒçš„ç¯„åœå…§å®šç¾©ä¸”æ²’æœ‰ç©©å®šåƒè€ƒï¼Œå°‡å°è‡´ç„¡é™è¿´åœˆï¼
  const table = useReactTable({
    columns,
    data,
  });

  return <table>...</table>;
}
```

### è§£æ±ºæ–¹æ¡ˆ 1ï¼šä½¿ç”¨ useMemo æˆ– useState æä¾›ç©©å®šåƒè€ƒ

åœ¨ React ä¸­ï¼Œä½ å¯ä»¥é€éå°‡è®Šæ•¸å®šç¾©åœ¨å…ƒä»¶å¤–éƒ¨/ä¸Šæ–¹ã€ä½¿ç”¨ `useMemo` æˆ– `useState`ï¼Œæˆ–ä½¿ç”¨ç¬¬ä¸‰æ–¹ç‹€æ…‹ç®¡ç†åº«ï¼ˆå¦‚ Redux æˆ– React Query ğŸ˜‰ï¼‰ä¾†æä¾›ã€Œç©©å®šã€çš„åƒè€ƒã€‚

```js
//âœ… æ­£ç¢ºï¼šåœ¨å…ƒä»¶å¤–éƒ¨å®šç¾© columns
const columns = [
  // ...
];

//âœ… æ­£ç¢ºï¼šåœ¨å…ƒä»¶å¤–éƒ¨å®šç¾© data
const data = [
  // ...
];

// é€šå¸¸æ›´å¯¦éš›çš„åšæ³•æ˜¯åœ¨å…ƒä»¶å…§éƒ¨å®šç¾© columns å’Œ dataï¼Œå› æ­¤ä½¿ç”¨ `useMemo` æˆ– `useState` ä¾†æä¾›ç©©å®šåƒè€ƒ
export default function MyComponent() {
  //âœ… æ­£ç¢ºï¼šé€™ä¸æœƒå°è‡´ç„¡é™é‡æ–°æ¸²æŸ“è¿´åœˆï¼Œå› ç‚º `columns` æ˜¯ä¸€å€‹ç©©å®šåƒè€ƒ
  const columns = useMemo(() => [
    // ...
  ], []);

  //âœ… æ­£ç¢ºï¼šé€™ä¸æœƒå°è‡´ç„¡é™é‡æ–°æ¸²æŸ“è¿´åœˆï¼Œå› ç‚º `data` æ˜¯ä¸€å€‹ç©©å®šåƒè€ƒ
  const [data, setData] = useState(() => [
    // ...
  ]);

  // Columns å’Œ data å®šç¾©ç‚ºç©©å®šåƒè€ƒï¼Œä¸æœƒå°è‡´ç„¡é™è¿´åœˆï¼
  const table = useReactTable({
    columns,
    data,
  });

  return <table>...</table>;
}
```

### é™·é˜± 2ï¼šåŸåœ°ä¿®æ”¹ columns æˆ– data

å³ä½¿ä½ ç‚ºåˆå§‹çš„ `columns` å’Œ `data` æä¾›äº†ç©©å®šåƒè€ƒï¼Œå¦‚æœä½ åŸåœ°ä¿®æ”¹å®ƒå€‘ï¼Œä»ç„¶å¯èƒ½é™·å…¥ç„¡é™è¿´åœˆã€‚é€™æ˜¯ä¸€å€‹å¸¸è¦‹çš„é™·é˜±ï¼Œä¸€é–‹å§‹å¯èƒ½ä¸æœƒæ³¨æ„åˆ°ã€‚å³ä½¿æ˜¯ç°¡å–®çš„å…§è¯ `data.filter()`ï¼Œå¦‚æœä¸å°å¿ƒä½¿ç”¨ï¼Œä¹Ÿå¯èƒ½å°è‡´ç„¡é™è¿´åœˆã€‚

```js
export default function MyComponent() {
  //âœ… æ­£ç¢º
  const columns = useMemo(() => [
    // ...
  ], []);

  //âœ… æ­£ç¢ºï¼ˆReact Query æœƒè‡ªå‹•ç‚º data æä¾›ç©©å®šåƒè€ƒï¼‰
  const { data, isLoading } = useQuery({
    //...
  });

  const table = useReactTable({
    columns,
    //âŒ éŒ¯èª¤ï¼šé€™æœƒå°è‡´ç„¡é™é‡æ–°æ¸²æŸ“è¿´åœˆï¼Œå› ç‚º `data` è¢«åŸåœ°ä¿®æ”¹ï¼ˆç ´å£äº†ç©©å®šåƒè€ƒï¼‰
    data: data?.filter(d => d.isActive) ?? [],
  });

  return <table>...</table>;
}
```

### è§£æ±ºæ–¹æ¡ˆ 2ï¼šè¨˜æ†¶åŒ–ä½ çš„è³‡æ–™è½‰æ›

ç‚ºäº†é¿å…ç„¡é™è¿´åœˆï¼Œä½ æ‡‰è©²ç¸½æ˜¯è¨˜æ†¶åŒ–ä½ çš„è³‡æ–™è½‰æ›ã€‚é€™å¯ä»¥é€é `useMemo` æˆ–é¡ä¼¼æ–¹æ³•å¯¦ç¾ã€‚

```js
export default function MyComponent() {
  //âœ… æ­£ç¢º
  const columns = useMemo(() => [
    // ...
  ], []);

  //âœ… æ­£ç¢º
  const { data, isLoading } = useQuery({
    //...
  });

  //âœ… æ­£ç¢ºï¼šé€™ä¸æœƒå°è‡´ç„¡é™é‡æ–°æ¸²æŸ“è¿´åœˆï¼Œå› ç‚º `filteredData` è¢«è¨˜æ†¶åŒ–äº†
  const filteredData = useMemo(() => data?.filter(d => d.isActive) ?? [], [data]);

  const table = useReactTable({
    columns,
    data: filteredData, // ç©©å®šåƒè€ƒï¼
  });

  return <table>...</table>;
}
```

### React Forget

ç•¶ React Forget ç™¼å¸ƒå¾Œï¼Œé€™äº›å•é¡Œå¯èƒ½å°±æœƒæˆç‚ºéå»å¼ã€‚æˆ–è€…ç›´æ¥ä½¿ç”¨ Solid.js... ğŸ¤“

## å¦‚ä½•åœ¨è³‡æ–™è®Šæ›´æ™‚é¿å…è¡¨æ ¼ç‹€æ…‹è‡ªå‹•é‡ç½®ï¼Ÿ

å¤§å¤šæ•¸æ’ä»¶ä½¿ç”¨çš„ç‹€æ…‹*é€šå¸¸*æ‡‰è©²åœ¨è³‡æ–™ä¾†æºè®Šæ›´æ™‚é‡ç½®ï¼Œä½†æœ‰æ™‚å¦‚æœä½ åœ¨å¤–éƒ¨éæ¿¾è³‡æ–™ã€ä¸å¯è®Šåœ°ç·¨è¼¯è³‡æ–™æ™‚æŸ¥çœ‹è³‡æ–™ï¼Œæˆ–åªæ˜¯å°è³‡æ–™é€²è¡Œä»»ä½•ä¸å¸Œæœ›è§¸ç™¼è¡¨æ ¼ç‹€æ…‹è‡ªå‹•é‡ç½®çš„å¤–éƒ¨æ“ä½œï¼Œä½ å¯èƒ½éœ€è¦æŠ‘åˆ¶é€™ç¨®è¡Œç‚ºã€‚

å°æ–¼é€™äº›æƒ…æ³ï¼Œæ¯å€‹æ’ä»¶éƒ½æä¾›äº†ä¸€ç¨®æ–¹æ³•ä¾†ç¦ç”¨ç‹€æ…‹åœ¨è³‡æ–™æˆ–å…¶ä»–ä¾è³´é …è®Šæ›´æ™‚è‡ªå‹•é‡ç½®ã€‚é€šéå°‡ä»»ä½•ç›¸é—œé¸é …è¨­ç½®ç‚º `false`ï¼Œä½ å¯ä»¥é˜»æ­¢è‡ªå‹•é‡ç½®è¢«è§¸ç™¼ã€‚

ä»¥ä¸‹æ˜¯ä¸€å€‹åŸºæ–¼ React çš„ç¯„ä¾‹ï¼Œå±•ç¤ºå¦‚ä½•åœ¨ç·¨è¼¯è¡¨æ ¼çš„ `data` ä¾†æºæ™‚é˜»æ­¢æ‰€æœ‰ç‹€æ…‹åƒå¹³å¸¸é‚£æ¨£è®Šæ›´ï¼š

```js
const [data, setData] = React.useState([])
const skipPageResetRef = React.useRef()

const updateData = newData => {
  // ç•¶ä½¿ç”¨æ­¤å‡½æ•¸æ›´æ–°è³‡æ–™æ™‚ï¼Œè¨­ç½®ä¸€å€‹æ¨™è¨˜
  // ä»¥ç¦ç”¨æ‰€æœ‰è‡ªå‹•é‡ç½®
  skipPageResetRef.current = true

  setData(newData)
}

React.useEffect(() => {
  // åœ¨è¡¨æ ¼æ›´æ–°å¾Œï¼Œç¸½æ˜¯ç§»é™¤æ¨™è¨˜
  skipPageResetRef.current = false
})

useReactTable({
  ...
  autoResetPageIndex: !skipPageResetRef.current,
  autoResetExpanded: !skipPageResetRef.current,
})
```

ç¾åœ¨ï¼Œç•¶æˆ‘å€‘æ›´æ–°è³‡æ–™æ™‚ï¼Œä¸Šè¿°è¡¨æ ¼ç‹€æ…‹å°‡ä¸æœƒè‡ªå‹•é‡ç½®ï¼
